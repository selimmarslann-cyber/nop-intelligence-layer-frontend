(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[264],{4456:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/withdrawals",function(){return n(926)}])},7134:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var i=n(5893),r=n(7294),l=n(1163),a=n(1664),o=n.n(a);let s=n(3454).env.NEXT_PUBLIC_API_URL||"http://localhost:5000";function d(e){let{children:t}=e,n=(0,l.useRouter)(),[a,o]=(0,r.useState)(""),[d,u]=(0,r.useState)(!0),[h,p]=(0,r.useState)(!1);async function x(){try{let e=await fetch("".concat(s,"/api/admin/me"),{credentials:"include"});if(e.ok){let t=await e.json();o(t.email)}else n.push("/admin/login")}catch(e){n.push("/admin/login")}}async function f(){try{await fetch("".concat(s,"/api/admin/logout"),{method:"POST",credentials:"include"}),n.push("/admin/login")}catch(e){n.push("/admin/login")}}(0,r.useEffect)(()=>{p(!0),x()},[]);let g=n.pathname;return(0,i.jsxs)("div",{style:{minHeight:"100vh",background:"#1E2328",display:"flex"},children:[(0,i.jsx)("aside",{style:{width:d?240:0,background:"rgba(248, 250, 252, 0.05)",backdropFilter:"blur(10px)",borderRight:"1px solid rgba(229, 231, 235, 0.1)",transition:"width 0.3s",overflow:"hidden",position:"fixed",height:"100vh",zIndex:100},children:(0,i.jsxs)("div",{style:{padding:20},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:32},children:[(0,i.jsx)("div",{style:{width:40,height:40,borderRadius:8,background:"linear-gradient(135deg, #C9A227 0%, #B8921F 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,fontWeight:700,color:"#1E2328"},children:"NOP"}),d&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:14,fontWeight:700,color:"#F8FAFC"},children:"Admin Panel"}),(0,i.jsx)("div",{style:{fontSize:11,color:"#999"},children:"Intelligence Layer"})]})]}),d&&(0,i.jsxs)("nav",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,i.jsx)(c,{href:"/admin",label:"Dashboard",icon:"\uD83D\uDCCA",active:"/admin"===g}),(0,i.jsx)(c,{href:"/admin/users",label:"Users",icon:"\uD83D\uDC65",active:"/admin/users"===g}),(0,i.jsx)(c,{href:"/admin/contributions",label:"Contributions",icon:"\uD83D\uDCDD",active:"/admin/contributions"===g}),(0,i.jsx)(c,{href:"/admin/withdraws",label:"Withdraws",icon:"\uD83D\uDCB0",active:"/admin/withdraws"===g}),(0,i.jsx)(c,{href:"/admin/burns",label:"Burn Counter",icon:"\uD83D\uDD25",active:"/admin/burns"===g}),(0,i.jsx)(c,{href:"/admin/events",label:"Boosted Events",icon:"⚡",active:"/admin/events"===g}),(0,i.jsx)(c,{href:"/admin/health",label:"System Health",icon:"\uD83D\uDC9A",active:"/admin/health"===g}),(0,i.jsx)(c,{href:"/admin/ai-monitor",label:"AI Monitor",icon:"\uD83E\uDD16",active:"/admin/ai-monitor"===g})]})]})}),(0,i.jsxs)("div",{style:{flex:1,marginLeft:d?240:0,transition:"margin-left 0.3s",display:"flex",flexDirection:"column"},children:[(0,i.jsxs)("header",{style:{background:"rgba(248, 250, 252, 0.05)",backdropFilter:"blur(10px)",borderBottom:"1px solid rgba(229, 231, 235, 0.1)",padding:"12px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("button",{onClick:()=>u(!d),style:{padding:"8px",background:"transparent",border:"1px solid rgba(229, 231, 235, 0.2)",borderRadius:6,color:"#F8FAFC",cursor:"pointer",fontSize:18},children:"☰"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,i.jsx)("span",{style:{fontSize:13,color:"#999"},children:h&&a||"Loading..."}),(0,i.jsx)("button",{onClick:f,style:{padding:"8px 16px",background:"#C9A227",color:"#1E2328",border:"none",borderRadius:6,fontSize:13,fontWeight:600,cursor:"pointer"},children:"Logout"})]})]}),(0,i.jsx)("main",{style:{flex:1,background:"#F8FAFC",overflow:"auto"},children:t})]})]})}function c(e){let{href:t,label:n,icon:r,active:l}=e;return(0,i.jsxs)(o(),{href:t,style:{display:"flex",alignItems:"center",gap:12,padding:"12px 16px",borderRadius:8,background:l?"rgba(201, 162, 39, 0.2)":"transparent",color:l?"#C9A227":"#F8FAFC",textDecoration:"none",fontSize:14,fontWeight:l?600:400,transition:"all 0.2s"},onMouseEnter:e=>{l||(e.currentTarget.style.background="rgba(201, 162, 39, 0.1)")},onMouseLeave:e=>{l||(e.currentTarget.style.background="transparent")},children:[(0,i.jsx)("span",{children:r}),(0,i.jsx)("span",{children:n})]})}},926:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var i=n(5893),r=n(7294),l=n(1163),a=n(7134);let o=n(3454).env.NEXT_PUBLIC_API_URL||"http://localhost:5000";function s(){let e=(0,l.useRouter)(),[t,n]=(0,r.useState)([]),[s,f]=(0,r.useState)(!0),[g,y]=(0,r.useState)(""),[j,b]=(0,r.useState)("pending"),[m,w]=(0,r.useState)(null);async function v(){f(!0),y("");try{let e="all"===j?"".concat(o,"/api/admin/withdrawals"):"".concat(o,"/api/admin/withdrawals?status=").concat(j),t=await fetch(e,{credentials:"include"});if(!t.ok)throw Error("Failed to load withdrawals");let i=await t.json();n(i.items||[])}catch(e){y(e.message||"Failed to load withdrawals")}finally{f(!1)}}async function F(){try{(await fetch("".concat(o,"/api/admin/me"),{credentials:"include"})).ok||e.push("/admin/login")}catch(t){e.push("/admin/login")}}async function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!m){w(e);try{let n=await fetch("".concat(o,"/api/admin/withdrawals/").concat(e,"/approve"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({txHash:t})}),i=await n.json();if(!n.ok)throw Error(i.error||"Failed to approve");await v()}catch(e){alert(e.message||"Failed to approve withdrawal")}finally{w(null)}}}async function A(e){if(!m&&confirm("Are you sure you want to reject this withdrawal? The balance will be refunded.")){w(e);try{let t=await fetch("".concat(o,"/api/admin/withdrawals/").concat(e,"/reject"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),n=await t.json();if(!t.ok)throw Error(n.error||"Failed to reject");await v()}catch(e){alert(e.message||"Failed to reject withdrawal")}finally{w(null)}}}function C(e){switch(e){case"pending":return"#FFA500";case"processing":return"#0040FF";case"done":return"#00AA00";case"failed":return"#FF0000";default:return"#666"}}return(0,r.useEffect)(()=>{F(),v()},[j]),(0,i.jsx)(a.Z,{children:(0,i.jsxs)("div",{style:{padding:24},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,i.jsx)("h1",{style:{margin:0,fontSize:28,fontWeight:800},children:"Withdrawals Admin"}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsxs)("select",{value:j,onChange:e=>b(e.target.value),onFocus:e=>{e.currentTarget.style.outline="2px solid #C9A227",e.currentTarget.style.outlineOffset="2px"},onBlur:e=>{e.currentTarget.style.outline="none"},style:{padding:"8px 12px",border:"1px solid #E5E7EB",borderRadius:8,fontSize:14,cursor:"pointer",outline:"none"},children:[(0,i.jsx)("option",{value:"all",children:"All Status"}),(0,i.jsx)("option",{value:"pending",children:"Pending"}),(0,i.jsx)("option",{value:"processing",children:"Processing"}),(0,i.jsx)("option",{value:"done",children:"Done"}),(0,i.jsx)("option",{value:"failed",children:"Failed"})]}),(0,i.jsx)("button",{onClick:v,onFocus:e=>{e.currentTarget.style.outline="2px solid #C9A227",e.currentTarget.style.outlineOffset="2px"},onBlur:e=>{e.currentTarget.style.outline="none"},style:c,children:"↻ Refresh"})]})]}),g&&(0,i.jsx)("div",{style:{padding:12,background:"#FFE5E5",color:"#FF0000",borderRadius:8,marginBottom:16},children:g}),s?(0,i.jsx)("div",{style:{padding:40,textAlign:"center",color:"#666"},children:"Loading withdrawals..."}):0===t.length?(0,i.jsxs)("div",{style:{padding:40,textAlign:"center",color:"#666"},children:["No withdrawals found with status: ",j]}):(0,i.jsx)("div",{style:d,children:(0,i.jsx)("div",{style:{overflowX:"auto"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{borderBottom:"2px solid #eee"},children:[(0,i.jsx)("th",{style:p,children:"ID"}),(0,i.jsx)("th",{style:p,children:"Address"}),(0,i.jsx)("th",{style:p,children:"Amount"}),(0,i.jsx)("th",{style:p,children:"Fee"}),(0,i.jsx)("th",{style:p,children:"Net Amount"}),(0,i.jsx)("th",{style:p,children:"Status"}),(0,i.jsx)("th",{style:p,children:"Tx Hash"}),(0,i.jsx)("th",{style:p,children:"Created"}),(0,i.jsx)("th",{style:p,children:"Actions"})]})}),(0,i.jsx)("tbody",{children:t.map(e=>{var t,n;return(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #f5f5f5"},children:[(0,i.jsxs)("td",{style:x,children:["#",e.id]}),(0,i.jsx)("td",{style:x,children:(0,i.jsx)("code",{style:{fontSize:12,color:"#0040FF"},children:(t=e.address)?"".concat(t.slice(0,6),"...").concat(t.slice(-4)):"-"})}),(0,i.jsx)("td",{style:x,children:parseFloat(e.amount).toLocaleString()}),(0,i.jsx)("td",{style:x,children:parseFloat(e.fee).toLocaleString()}),(0,i.jsx)("td",{style:x,children:(0,i.jsx)("strong",{children:parseFloat(e.netAmount).toLocaleString()})}),(0,i.jsx)("td",{style:x,children:(0,i.jsx)("span",{style:{padding:"4px 8px",borderRadius:4,fontSize:11,fontWeight:600,background:C(e.status)+"20",color:C(e.status)},children:e.status.toUpperCase()})}),(0,i.jsx)("td",{style:x,children:e.txHash?(0,i.jsxs)("a",{href:"https://explorer.zksync.io/tx/".concat(e.txHash),target:"_blank",rel:"noopener noreferrer",style:{color:"#0040FF",fontSize:12},children:[e.txHash.slice(0,10),"..."]}):"-"}),(0,i.jsx)("td",{style:x,children:(n=e.createdAt)?new Date(n).toLocaleString():"-"}),(0,i.jsxs)("td",{style:x,children:["pending"===e.status&&(0,i.jsxs)("div",{style:{display:"flex",gap:6},children:[(0,i.jsx)("button",{onClick:()=>{let t=prompt("Enter transaction hash (optional):");null!==t&&S(e.id,t||null)},disabled:m===e.id,onFocus:e=>{e.currentTarget.disabled||(e.currentTarget.style.outline="2px solid #00AA00",e.currentTarget.style.outlineOffset="2px")},onBlur:e=>{e.currentTarget.style.outline="none"},style:{...u,opacity:m===e.id?.6:1},children:m===e.id?"...":"Approve"}),(0,i.jsx)("button",{onClick:()=>A(e.id),disabled:m===e.id,onFocus:e=>{e.currentTarget.disabled||(e.currentTarget.style.outline="2px solid #FF0000",e.currentTarget.style.outlineOffset="2px")},onBlur:e=>{e.currentTarget.style.outline="none"},style:{...h,opacity:m===e.id?.6:1},children:"Reject"})]}),"pending"!==e.status&&(0,i.jsx)("span",{style:{color:"#999",fontSize:12},children:"-"})]})]},e.id)})})]})})})]})})}let d={background:"#F8FAFC",border:"1px solid #E5E7EB",borderRadius:8,padding:16,boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"},c={background:"#C9A227",color:"#1E2328",border:"none",padding:"8px 16px",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600,transition:"all 0.2s",outline:"none"},u={background:"#00AA00",color:"#fff",border:"none",padding:"6px 12px",borderRadius:8,cursor:"pointer",fontSize:12,fontWeight:600,transition:"all 0.2s",outline:"none"},h={background:"#FF0000",color:"#fff",border:"none",padding:"6px 12px",borderRadius:8,cursor:"pointer",fontSize:12,fontWeight:600,transition:"all 0.2s",outline:"none"},p={padding:"12px 8px",textAlign:"left",fontSize:12,fontWeight:700,color:"#666",textTransform:"uppercase",letterSpacing:.5},x={padding:"12px 8px",fontSize:13,color:"#111"}}},function(e){e.O(0,[424,888,774,179],function(){return e(e.s=4456)}),_N_E=e.O()}]);